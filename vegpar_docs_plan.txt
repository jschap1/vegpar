vegpar R package
Creating vegetation parameter files for the VIC model

Key directories:
/hdd/.../Vegetation_Fractions
/hdd/.../Vegetation_Fractions/Codes
~/Documents/Codes/vegpar
~/Documents/Codes/vegpar/docs
~/Documents/ESSD/codes/

Should also check out Dissertation Ch. 2 for more discussion, description, and figures.

-> As part of revising the ESSD paper, create documentation for vegpars that includes a detailed description of how the VIC vegetation files were created.

=====From ESSD paper (revise?)=====

VIC uses a vegetation parameter file to define the fractional cover of different vegetation types within each grid cell and some of their physical properties. The vegetation parameter file consists of information about fractional cover of each land cover type in each grid cell, and their corresponding root zone depths and root fractions. The vegetation parameter file can optionally include time-varying LAI, fractional canopy cover, and albedo data, but we chose to specify these in the vegetation library, instead, for simplicity.

We used MODIS land cover data from the 0.05° MODIS MCD12C1 Version 6 data product (Friedl and Sulla-Menashe, 2015) to assign a land cover type to each grid cell. Land cover fractions were assigned to each grid cell by calculating the average land cover for MCD12C1 observations for the year 2017. We chose 2017 because it was the most recent year with data in all of the MODIS-based datasets used for this study. A future update to VICGlobal could incorporate multi-year vegetation climatology. Figure 3 shows the majority land cover types from the 2017 MCD12C1 observations.

We calculated root fraction as a function of land cover class following the method of Zeng (2001), who defined the following formula (Equation 5) for use in parameterizing land surface models:

    			    	      (5)

where  cumulative root fraction,  depth, and a and b are empirical parameters defined by Zeng (2001) for each IGBP land cover type, based on a rooting depth database compiled from more than 200 field surveys. We used this formula with depths of 0.1 m, 0.7 m, and dr, corresponding to three root zones. The value of dr, the maximum rooting depth, was taken from Zeng (2001). This method assumes that the depth and distribution of roots depends only on the land cover type; we assume that land cover type is the primary control on root characteristics. Figure 4 shows area-weighted average root fractions for each root zone, averaged over the 17 IGBP land cover classes.

Like previous large-scale VIC vegetation cover datasets, our vegetation parameter file neglects land cover change over time. However, it does have a few other advantages over past vegetation parameter datasets, notably that it uses 17 International Geosphere–Biosphere Programme (IGBP) land cover classes, including urban, barren, snow and ice, and inland water bodies, which is an improvement upon the 11 UMD-NLDAS land cover types used in the Nijssen et al. (2001) and L2013 VIC parameter sets, in which urban land areas are treated as “bare soil.” We refer to the land cover classification used in these older VIC parameterizations as "UMD-NLDAS" because it is a modified version of the AVHRR-based University of Maryland (UMD; Hansen et al., 2000) land cover product. The UMD-NLDAS classification was modified for the North American Land Data Assimilation project (NLDAS; Mitchell et al., 2004) to exclude open water, urban, and snow and ice land cover classes (see BV2019).

3.4 Vegetation library file

The vegetation library maps each land cover type to a set of vegetation parameters (Table 3). We adapted the LDAS vegetation library from Cherkauer (1999), which was originally created for use with the 11 UMD-NLDAS land cover types and has been used for both the Nijssen et al. (2001a) and L2013 VIC parameterizations. The datasets that went into creating this vegetation library file are described in Nijssen et al. (2001a). We improved upon the LDAS vegetation library by estimating monthly average LAI, fractional canopy cover, and albedo values using several MODIS data products. We set the values of the rest of the parameters in the vegetation library to values from the existing LDAS vegetation library. Details follow.

We used MODIS observations from the year 2017 to calculate monthly average LAI, fractional canopy cover, and albedo for each IGBP land cover type, following BV2019. We calculated LAI from the Global LAnd Surface Satellite dataset (GLASS; Liang et al., 2013ab; Xiao et al., 2016b), fractional canopy cover from NDVI observations (MCD13C1; Didan, 2015), and white-sky albedo from MCD43C3 (Schaaf and Wang, 2015). The expression used for fractional canopy cover was the same as used by BV2019:

 			    (6)

where NDVImin and NDVImax are the minimum and maximum values of NDVI observed for that month.

To calculate global average monthly vegetation parameters would be of limited use because the seasonal cycle would average out across the equator. Therefore, we calculated average fractional canopy cover, LAI, and albedo for each vegetation type in each hemisphere, and developed two vegetation library files: one for the northern hemisphere and one for the southern hemisphere. Maps of January and July LAI, fractional canopy cover, and albedo in the northern hemisphere are shown in Figure 5; the parameter values in this figure have been averaged over the 17 IGBP land cover classes using area-based weighting. (Figures S14-S19 show maps of the the remaining vegetation parameters.) Figures S20-S22 show the cycle of LAI, fractional canopy cover, and albedo for each vegetation type, averaged separately over each hemisphere. The figures also include a comparison with the L2013 vegetation parameters, which were estimated using data from the continental United States only. 

For the other parameters in the vegetation library file (architectural resistance, roughness length, etc.), we assigned values using the existing LDAS vegetation library. Since there are 17 IGBP land cover classes, and only 11 UMD-NLDAS land cover classes in the LDAS vegetation library, we re-assigned some IGBP land cover classes to take the parameters of UMD-NLDAS land cover classes. We remapped barren land, permanent wetlands, snow and ice, urban land, and water bodies to take the parameters of “grasslands” from the LDAS vegetation parameter file. While the characteristics of the barren, snow and ice, urban, and water land cover types must clearly differ from those of grasslands, as pointed out by BV2019, their fractional canopy cover values are generally low, mitigating the negative impact of this assumption. The other remappings were less problematic. Croplands and croplands/natural vegetation mosaics became “croplands,” savannas became “wooded grasslands,” and woody savannas became “woodlands.” Thus we were able to assign vegetation parameter value to the each of the 17 IGBP land cover classes.